{"name":"[ Generate a Sector ]","type":"script","author":"DNjZbxRejd6RrNH5","img":"systems/ironsworn/img/icon-hexspace.png","scope":"global","command":"let sizeWidth = 3200;\nlet sizeHeight = 1600;\nlet folder1 = \"Sector Name Prefixes\"\nlet folder2 = \"Sector Name Suffixes\"\n\n\nlet tables = game.folders.getName(folder1);\nlet table = tables.content[Math.floor(Math.random() * tables.content.length)];\nlet roll = await table.roll();\nlet sector = roll.results[0].data.text;\n\ntables = game.folders.getName(folder1);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nroll = await table.roll();\nsector += \" \" + roll.results[0].data.text;\n\nawait Folder.create({name: sector, type: \"JournalEntry\", parent: null});\n\nlet sectorID = game.folders.getName(sector).id;\nconst journal = await JournalEntry.create({name: \"[ \" + sector + \" - Sector Dossier ]\", content: \"\", folder: sectorID});\n\nScene.create({\n  name: sector,\n  backgroundColor: \"#000000\",\n  width: sizeWidth,\n  height: sizeHeight,\n  padding: 0,\n  gridType: 2,\n  grid: 130,\n  gridColor: \"#ffffff\",\n  gridAlpha: 0.5,\n  gridDistance: 0.5,\n  gridUnits: \"LY\",\n  navName: sector,\n  active: true,\n  initial: {\n    x: 1840,\n    y: 801,\n    scale: 0.47\n    },\n  journal: journal._id\n});\n\nlet message = new ChatMessage({\n    user: game.user._id,\n    type: CONST.CHAT_MESSAGE_TYPES.EMOTE,\n    content: \"<h3>You have arrived at the <b>\" + sector + \"</b> sector. Initiate a Sector Scan at your convenience. Data storage has been allocated in the Captain's Log.</h3>\"\n});\n\nChatMessage.create(message);","folder":null,"sort":0,"permission":{"default":0,"DNjZbxRejd6RrNH5":3},"flags":{"core":{"sourceId":"Macro.Ad4nwnHdNOH4bosm"}},"_id":"4AFLF0WfODQj9gG2"}
{"name":"[ Generate a Settlement ]","type":"script","author":"DNjZbxRejd6RrNH5","img":"icons/magic/air/weather-sunlight-sky.webp","scope":"global","command":"let sizeWidth = 3200;\nlet sizeHeight = 1600;\n\nconst sectorSize = \"Terminus\";\n\nconst folder1 = \"Settlement Name Prefixes\";\nconst folder2 = \"Settlement Names\";\nconst folder3 = \"Settlement Name Suffixes\";\nconst folder4 = \"Settlement Projects\";\nconst folder5 = \"Settlement Troubles\";\nconst folder6 = \"Settlement Locations\";\nconst folder7 = \"Settlement Populations - \" + sectorSize;\nconst folder8 = \"Settlement Authorities\";\nlet path = \"./systems/ironsworn/img/settlements/\";\n\nlet prefix = false;\nlet tables;\nlet table;\nlet settlementRoll;\nlet settlementName = \"\";\nlet holder;\n\ntables = game.folders.getName(folder1);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\nholder = settlementRoll.results[0].data.text;\nif ( holder == \"None\") { }\nelse { \n  settlementName = holder + \" \";\n  prefix = true;\n}\n\ntables = game.folders.getName(folder2);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\nsettlementName += settlementRoll.results[0].data.text;\n\nif ( prefix == false) {\n  tables = game.folders.getName(folder3);\n  table = tables.content[Math.floor(Math.random() * tables.content.length)];\n  settlementRoll = await table.roll();\n  holder = settlementRoll.results[0].data.text;\n  if ( holder == \"None\") { }\n  else { settlementName += \" \" + holder; }\n}\n\nlet dossier = \"<h2><p><b>\" + settlementName + \"</b></p></h2>\";\n\ntables = game.folders.getName(folder6);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\ndossier += \"<p><b>Location: </b>\" + settlementRoll.results[0].data.text + \" \";\n\nlet settlementIcon = path + settlementRoll.results[0].data.text + \".png\";\ndossier += \"<img src='\" + settlementIcon + \"' height='30' width='30'></p>\";\n\ntables = game.folders.getName(folder7);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\ndossier += \"<p><b>Population: </b>\" + settlementRoll.results[0].data.text + \"</p>\";\n\ntables = game.folders.getName(folder8);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\ndossier += \"<p><b>Authority: </b>\" + settlementRoll.results[0].data.text + \"</p>\";\n\ntables = game.folders.getName(folder4);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\ndossier += \"<p><b>Projects: </b>\" + settlementRoll.results[0].data.text + \"</p>\";\n\nif ( (Math.floor(Math.random() * 2)) > 1) {\n  tables = game.folders.getName(folder4);\n  table = tables.content[Math.floor(Math.random() * tables.content.length)];\n  settlementRoll = await table.roll();\n  dossier += \", \" + settlementRoll.results[0].data.text + \"</p>\";\n}\n\ntables = game.folders.getName(folder5);\ntable = tables.content[Math.floor(Math.random() * tables.content.length)];\nsettlementRoll = await table.roll();\nif (settlementRoll.results[0].data.text == \"Roll twice\") {\n  tables = game.folders.getName(folder5);\n  table = tables.content[Math.floor(Math.random() * tables.content.length)];\n  settlementRoll = await table.roll();\n  dossier += \"<p><b>Troubles: </b>\" + settlementRoll.results[0].data.text + \", \";\n  tables = game.folders.getName(folder5);\n  table = tables.content[Math.floor(Math.random() * tables.content.length)];\n  settlementRoll = await table.roll();\n  dossier += settlementRoll.results[0].data.text + \"</p>\";\n}\nelse {\n  dossier += \"<p><b>Troubles: </b>\" + settlementRoll.results[0].data.text + \"</p>\";\n}\n\nlet sector = game.scenes.viewed.name;\nlet sectorID = game.folders.getName(sector).id;\nlet journal = await JournalEntry.create({name: settlementName, content: dossier, folder: sectorID});\n\nconsole.log(journal);\n\nlet xN = new Roll(\"1d\" + sizeWidth);\nxN.evaluate();\nlet yN = new Roll(\"1d\" + sizeHeight);\nyN.evaluate();\n\nNote.create({\n  entryId: journal.id,\n  x: xN.result,\n  y: yN.result,\n  icon: settlementIcon,\n  iconSize: 80,\n  iconTint: \"#00FF00\",\n  text: journal.name,\n  fontSize: 24,\n  textAnchor: CONST.TEXT_ANCHOR_POINTS.BOTTOM,\n  textColor: \"#00FFFF\"\n});\n\nChatMessage.create({content: dossier});","folder":null,"sort":0,"permission":{"default":0,"DNjZbxRejd6RrNH5":3},"flags":{"core":{"sourceId":"Macro.HmfUcXsrnRkAwV0G"}},"_id":"HRE9AD322NumQRn2"}
{"name":"Roll Template","type":"script","author":"DNjZbxRejd6RrNH5","img":"icons/svg/dice-target.svg","scope":"global","command":"let folder1 = \"[ Actions ]\"\n\nlet tables = game.folders.getName(folder1);\nlet table = tables.content[Math.floor(Math.random() * tables.content.length)];\n\ntable.draw();","folder":null,"sort":0,"permission":{"default":0,"DNjZbxRejd6RrNH5":3},"flags":{"core":{"sourceId":"Macro.QbsftFwJJoXFpPbC"}},"_id":"b5zwiL5W0suf4l6F"}
{"name":"Create Starforged Rolltable Folders - Run Once!","type":"script","author":"DNjZbxRejd6RrNH5","img":"icons/svg/dice-target.svg","scope":"global","command":"const rootFolder = \"[ Starforged Oracles ]\";\n\nawait Folder.create({name: rootFolder, type: \"RollTable\", parent: null});\n\nlet parentID = game.folders.getName(rootFolder);\n\nawait Folder.create({name: \"[ Actions ]\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"[ Themes ]\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"[ Descriptors ]\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"[ Foci ]\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Planets\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Sectors\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlements\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Space\", type: \"RollTable\", parent: parentID});\n\nparentID = game.folders.getName(\"Planets\");\n\nawait Folder.create({name: \"[ Planetary Classes ]\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Desert World\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Furnace World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Grave World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Ice World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Jovian World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Jungle World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Ocean World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Rocky World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Shattered World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Tainted World\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Vital World\", type: \"RollTable\", parent: parentID})\n\nparentID = game.folders.getName(\"Sectors\");\n\nawait Folder.create({name: \"Sector Name Prefixes\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Sector Name Suffixes\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Stellar Objects\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Sector Troubles\", type: \"RollTable\", parent: parentID})\n\nparentID = game.folders.getName(\"Settlements\");\n\nawait Folder.create({name: \"Settlement Authorities\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement First Looks\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Initial Contacts\", type: \"RollTable\", parent: parentID})\nawait Folder.create({name: \"Settlement Locations\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Name Prefixes\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Name Suffixes\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Names\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Populations - Expanse\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Populations - Outlands\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Populations - Terminus\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Projects\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Settlement Troubles\", type: \"RollTable\", parent: parentID});\n\nparentID = game.folders.getName(\"Space\");\n\nawait Folder.create({name: \"Space Sightings\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Spacebourne Opportunities\", type: \"RollTable\", parent: parentID});\nawait Folder.create({name: \"Spacebourne Perils\", type: \"RollTable\", parent: parentID});","folder":null,"sort":0,"permission":{"default":0,"DNjZbxRejd6RrNH5":3},"flags":{"core":{"sourceId":"Macro.CZEA4HLqghPNuPsq"}},"_id":"rJJIIXEeZyL6mVL4"}
{"name":"[ Generate a Planet ]","type":"script","author":"DNjZbxRejd6RrNH5","img":"systems/ironsworn/img/planets/Ocean%20World.png","scope":"global","command":"let sizeWidth = 3200;\nlet sizeHeight = 1600;\nlet folder1 = \"[ Planetary Classes ]\";\nlet sectorSize = \"Terminus\";\nlet path = \"./systems/ironsworn/img/planets/\";\n\nlet tables = game.folders.getName(folder1);\n\nlet table = tables.content[Math.floor(Math.random() * tables.content.length)];\nlet planetRoll = await table.roll();\nlet planet = planetRoll.results[0].data.text;\nlet dossier = \"<h2><p><b>\" + planet + \"</b></p></h2>\";\n\ntable = game.tables.getName(planet + \" - Atmosphere\");\nlet tableRoll = await table.roll();\nlet content = tableRoll.results[0].data.text;\ndossier += \"<p><b>Atmosphere:</b> \" + content;\n\ntable = game.tables.getName(planet + \" - Settlements - \" + sectorSize);\ntableRoll = await table.roll();\ncontent = tableRoll.results[0].data.text;\ndossier += \"<p><b>Settlements:</b> \" + content;\n\ntable = game.tables.getName(planet + \" - Observed From Space\");\ntableRoll = await table.roll();\ncontent = tableRoll.results[0].data.text;\nif (content == \"Descriptor + Focus\") {\n    tables = game.folders.getName(\"[ Descriptors ]\");\n    table = tables.content[Math.floor(Math.random() * tables.content.length)]\n    tableRoll = await table.roll();\n    content = tableRoll.results[0].data.text;\n    tables = game.folders.getName(\"[ Foci ]\");\n    table = tables.content[Math.floor(Math.random() * tables.content.length)]\n    tableRoll = await table.roll();\n    content += \" \" + tableRoll.results[0].data.text;\n}\ndossier += \"<p><b>Observed From Space:</b> \" + content;\n\nlet random = new Roll(\"1d2\").roll().total;\nif (random > 1) {\n  tableRoll = await table.roll();\n  let temp = tableRoll.results[0].data.text;\n  if (temp == \"Descriptor + Focus\") {\n      tables = game.folders.getName(\"[ Descriptors ]\");\n      table = tables.content[Math.floor(Math.random() * tables.content.length)]\n      tableRoll = await table.roll();\n      temp = tableRoll.results[0].data.text;\n      tables = game.folders.getName(\"[ Foci ]\");\n      table = tables.content[Math.floor(Math.random() * tables.content.length)]\n      tableRoll = await table.roll();\n      temp += \" \" + tableRoll.results[0].data.text;\n  }\n  if (content == temp) {\n    content = \" (abundant)\";\n  }\n  else {\n    content = \", \" + temp;\n  }\n  dossier += content;\n}\n\ntable = game.tables.getName(planet + \" - Planetside Feature\");\ntableRoll = await table.roll();\ncontent = tableRoll.results[0].data.text;\nif (content == \"Descriptor + Focus\") {\n    tables = game.folders.getName(\"[ Descriptors ]\");\n    table = tables.content[Math.floor(Math.random() * tables.content.length)]\n    tableRoll = await table.roll();\n    content = tableRoll.results[0].data.text;\n    tables = game.folders.getName(\"[ Foci ]\");\n    table = tables.content[Math.floor(Math.random() * tables.content.length)]\n    tableRoll = await table.roll();\n    content += \" \" + tableRoll.results[0].data.text;\n}\ndossier += \"<p><b>Planetside Feature:</b> \" + content;\n\nrandom = new Roll(\"1d2\").roll().total;\nif (random > 1) {\n  tableRoll = await table.roll();\n  let temp = tableRoll.results[0].data.text;\n  if (temp == \"Descriptor + Focus\") {\n      tables = game.folders.getName(\"[ Descriptors ]\");\n      table = tables.content[Math.floor(Math.random() * tables.content.length)]\n      tableRoll = await table.roll();\n      temp = tableRoll.results[0].data.text;\n      tables = game.folders.getName(\"[ Foci ]\");\n      table = tables.content[Math.floor(Math.random() * tables.content.length)]\n      tableRoll = await table.roll();\n      temp += \" \" + tableRoll.results[0].data.text;\n  }\n  if (content == temp) {\n    content = \" (abundant)\";\n  }\n  else {\n    content = \", \" + temp;\n  }\n  dossier += content;\n}\n\ntable = game.tables.getName(planet + \" - Life\");\ntableRoll = await table.roll();\ncontent = tableRoll.results[0].data.text;\ndossier += \"<p><b>Life:</b> \" + content + \"</p>\";\n\nif (planet == \"Vital World\") {\n  table = game.tables.getName(planet + \" - Diversity\");\n  tableRoll = await table.roll();\n  let diversity = tableRoll.results[0].data.text;\n  dossier += \"<p><b>Diversity:</b> \" + diversity + \"</p>\";\n\n  let biomeCount = 2;\n  if ( diversity == \"Diverse\" ) { biomeCount = 3; }\n  if ( diversity == \"Complex\" ) { biomeCount = 4; }\n  if ( diversity == \"Garden world\" ) { biomeCount = 5; }\n\n  table = game.tables.getName(planet + \" - Biomes\");\n  content = \"<p><b>Biomes:</b> \";\n  for (count = 0; count < biomeCount; count++) {\n    tableRoll = await table.roll();\n    let biomes = tableRoll.results[0].data.text;\n    content += biomes;\n    if (count < biomeCount - 1) { content += \", \"; }\n  }\n    dossier += content + \"</p>\";\n}\n\ndossier += \"<img src='\" + path + planet + \".png'>\";\n\nlet sector = game.scenes.viewed.name;\nlet sectorID = game.folders.getName(sector).id;\nlet journal = await JournalEntry.create({name: planet, content: dossier, folder: sectorID});\n\nlet xN = new Roll(\"1d\" + sizeWidth);\nxN.evaluate();\nlet yN = new Roll(\"1d\" + sizeHeight);\nyN.evaluate();\n\nlet iconSize = new Roll(\"1d40\").roll().total + 80;\n\nNote.create({\n  entryId: journal.id,\n  x: xN.result,\n  y: yN.result,\n  icon: path + planet + \".png\",\n  iconSize: iconSize,\n  iconTint: \"#fff\",\n  text: journal.name,\n  fontSize: 36,\n  textAnchor: CONST.TEXT_ANCHOR_POINTS.BOTTOM,\n  textColor: \"#00FFFF\"\n});\n\nChatMessage.create({content: dossier});","folder":null,"sort":0,"permission":{"default":0,"DNjZbxRejd6RrNH5":3},"flags":{"core":{"sourceId":"Macro.UNCguuYKfgGBbebr"}},"_id":"unfE6ggGFn8ecMnH"}
